<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Convert</title>
   <script>
      function dodrop(event)
{
  var dt = event.dataTransfer;
  var files = dt.files;
  
    for (var i = 0; i < files.length; i++) {
      reader = new FileReader();
      reader.onload = function (event) {
        
        const input = event.target.result;
        let result = input.split('\n').map(function(s) { if (s) { return JSON.parse(s); } });

        const replacer = (key, value) => value === null ? '' : value // specify how you want to handle null values here
        const header = Object.keys(result[0])
        console.log(header);
        console.log(result[0]);

        const lines = [];
        
        result.forEach(function (row) { 
          const rows = [];
          console.log(row["data"]["legacy"]["full_text"]);
            //header.map(function(fieldName) { return JSON.stringify(jrow[fieldName], replacer) }).join(',' ) 
            header.forEach(fieldName => rows.push( JSON.stringify("body", row["data"]["legacy"]["full_text"]) ) )
          
          lines.push(rows.join(','))
        } );
        const csv = [
          header.join(','), // header row first
          lines
          //...result.map(function(row) { header.map(fieldName => JSON.stringify(row[fieldName], replacer)).join(',' ) } )
        ].join('\n')
        document.getElementById('csv').innerText = csv;
      };
      reader.readAsText(files[i]);
    }
}
   </script>
</head>
<body>

<div id="output" style="min-height: 200px; white-space: pre; border: 1px solid black;"
     ondragenter="document.getElementById('output').textContent = ''; event.stopPropagation(); event.preventDefault();"
     ondragover="event.stopPropagation(); event.preventDefault();"
     ondrop="event.stopPropagation(); event.preventDefault();
     dodrop(event);">
     DROP FILES HERE FROM FINDER OR EXPLORER
</div>
<div id="csv"></div>


</body>
</html>
